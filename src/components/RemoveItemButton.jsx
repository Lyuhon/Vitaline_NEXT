// // RemoveItemButton.jsx

// 'use client';

// import { useState } from 'react';

// export default function RemoveItemButton({ productId }) {
//     const [loading, setLoading] = useState(false);

//     const removeItem = async () => {
//         setLoading(true);
//         await fetch('/api/cart/remove', {
//             method: 'POST',
//             headers: { 'Content-Type': 'application/json' },
//             body: JSON.stringify({ productId })
//         });
//         // После удаления товара обновим страницу
//         window.location.reload();
//     };

//     return (
//         <div className="item-remove" onClick={removeItem} style={{ cursor: loading ? 'wait' : 'pointer' }}>
//             <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
//                 xmlns="http://www.w3.org/2000/svg">
//                 <path
//                     d="M5.74857 5.41662C5.74857 5.00241 5.41278 4.66662 4.99857 4.66662C4.58435 4.66662 4.24857 5.00241 4.24857 5.41662H5.74857ZM15.7527 4.99995C15.7527 4.58574 15.4169 4.24995 15.0027 4.24995C14.5885 4.24995 14.2527 4.58574 14.2527 4.99995H15.7527ZM12.418 8.33259C12.418 7.91838 12.0822 7.58259 11.668 7.58259C11.2538 7.58259 10.918 7.91838 10.918 8.33259H12.418ZM10.918 14.1684C10.918 14.5826 11.2538 14.9184 11.668 14.9184C12.0822 14.9184 12.418 14.5826 12.418 14.1684H10.918ZM9.08329 8.33259C9.08329 7.91838 8.7475 7.58259 8.33329 7.58259C7.91908 7.58259 7.58329 7.91838 7.58329 8.33259H9.08329ZM7.58329 14.1684C7.58329 14.5826 7.91908 14.9184 8.33329 14.9184C8.7475 14.9184 9.08329 14.5826 9.08329 14.1684H7.58329ZM3.74805 4.24787C3.33383 4.24787 2.99805 4.58366 2.99805 4.99787C2.99805 5.41208 3.33383 5.74787 3.74805 5.74787V4.24787ZM16.2533 5.74787C16.6675 5.74787 17.0033 5.41208 17.0033 4.99787C17.0033 4.58366 16.6675 4.24787 16.2533 4.24787V5.74787ZM5.95442 4.7607C5.82343 5.15366 6.0358 5.5784 6.42876 5.70938C6.82172 5.84037 7.24646 5.628 7.37744 5.23504L5.95442 4.7607ZM7.11945 3.6373L7.83096 3.87447L7.83102 3.8743L7.11945 3.6373ZM8.70178 2.49683L8.7016 3.24683H8.70178V2.49683ZM11.2995 2.49683V3.24683L11.3005 3.24683L11.2995 2.49683ZM12.8835 3.6373L13.5953 3.40092L13.5951 3.4003L12.8835 3.6373ZM12.6236 5.23425C12.7542 5.62736 13.1787 5.84019 13.5718 5.70964C13.9649 5.57909 14.1777 5.15459 14.0471 4.76148L12.6236 5.23425ZM4.24857 5.41662V15.8357H5.74857V5.41662H4.24857ZM4.24857 15.8357C4.24857 17.1708 5.33086 18.2531 6.66593 18.2531V16.7531C6.15928 16.7531 5.74857 16.3424 5.74857 15.8357H4.24857ZM6.66593 18.2531H13.3354V16.7531H6.66593V18.2531ZM13.3354 18.2531C14.6704 18.2531 15.7527 17.1708 15.7527 15.8357H14.2527C14.2527 16.3424 13.842 16.7531 13.3354 16.7531V18.2531ZM15.7527 15.8357V4.99995H14.2527V15.8357H15.7527ZM10.918 8.33259V14.1684H12.418V8.33259H10.918ZM7.58329 8.33259V14.1684H9.08329V8.33259H7.58329ZM3.74805 5.74787H16.2533V4.24787H3.74805V5.74787ZM7.37744 5.23504L7.83096 3.87447L6.40794 3.40013L5.95442 4.7607L7.37744 5.23504ZM7.83102 3.8743C7.95585 3.49952 8.30657 3.24673 8.7016 3.24683L8.70196 1.74683C7.66102 1.74658 6.73682 2.41271 6.40788 3.4003L7.83102 3.8743ZM8.70178 3.24683H11.2995V1.74683H8.70178V3.24683ZM11.3005 3.24683C11.6958 3.24634 12.047 3.4992 12.1719 3.8743L13.5951 3.4003C13.2659 2.41186 12.3404 1.74554 11.2986 1.74683L11.3005 3.24683ZM12.1717 3.87369L12.6236 5.23425L14.0471 4.76148L13.5953 3.40092L12.1717 3.87369Z"
//                     fill="#2E5500" />
//             </svg>
//         </div>
//     );
// }



// LOCAL Storage
// RemoveItemButton.jsx
'use client';

import { useState } from 'react';

export default function RemoveItemButton({ productId }) {
    const [loading, setLoading] = useState(false);
    const CART_KEY = 'vitaline_cart';

    const removeItem = () => {
        setLoading(true);
        try {
            // Получаем текущую корзину из localStorage
            const cartData = localStorage.getItem(CART_KEY);
            let cart = cartData ? JSON.parse(cartData) : { items: [] };

            // Удаляем товар из корзины
            cart.items = cart.items.filter((item) => item.productId !== productId);

            // Сохраняем обновленную корзину
            localStorage.setItem(CART_KEY, JSON.stringify(cart));

            // Отправляем событие об обновлении корзины
            window.dispatchEvent(new Event('cartUpdate'));

            // Обновляем страницу для отображения изменений
            window.location.reload();
        } catch (error) {
            console.error('Error removing item from cart:', error);
        } finally {
            setLoading(false);
        }
    };

    return (
        <div className="item-remove" onClick={removeItem} style={{ cursor: loading ? 'wait' : 'pointer' }}>
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M5.74857 5.41662C5.74857 5.00241 5.41278 4.66662 4.99857 4.66662C4.58435 4.66662 4.24857 5.00241 4.24857 5.41662H5.74857ZM15.7527 4.99995C15.7527 4.58574 15.4169 4.24995 15.0027 4.24995C14.5885 4.24995 14.2527 4.58574 14.2527 4.99995H15.7527ZM12.418 8.33259C12.418 7.91838 12.0822 7.58259 11.668 7.58259C11.2538 7.58259 10.918 7.91838 10.918 8.33259H12.418ZM10.918 14.1684C10.918 14.5826 11.2538 14.9184 11.668 14.9184C12.0822 14.9184 12.418 14.5826 12.418 14.1684H10.918ZM9.08329 8.33259C9.08329 7.91838 8.7475 7.58259 8.33329 7.58259C7.91908 7.58259 7.58329 7.91838 7.58329 8.33259H9.08329ZM7.58329 14.1684C7.58329 14.5826 7.91908 14.9184 8.33329 14.9184C8.7475 14.9184 9.08329 14.5826 9.08329 14.1684H7.58329ZM3.74805 4.24787C3.33383 4.24787 2.99805 4.58366 2.99805 4.99787C2.99805 5.41208 3.33383 5.74787 3.74805 5.74787V4.24787ZM16.2533 5.74787C16.6675 5.74787 17.0033 5.41208 17.0033 4.99787C17.0033 4.58366 16.6675 4.24787 16.2533 4.24787V5.74787ZM5.95442 4.7607C5.82343 5.15366 6.0358 5.5784 6.42876 5.70938C6.82172 5.84037 7.24646 5.628 7.37744 5.23504L5.95442 4.7607ZM7.11945 3.6373L7.83096 3.87447L7.83102 3.8743L7.11945 3.6373ZM8.70178 2.49683L8.7016 3.24683H8.70178V2.49683ZM11.2995 2.49683V3.24683L11.3005 3.24683L11.2995 2.49683ZM12.8835 3.6373L13.5953 3.40092L13.5951 3.4003L12.8835 3.6373ZM12.6236 5.23425C12.7542 5.62736 13.1787 5.84019 13.5718 5.70964C13.9649 5.57909 14.1777 5.15459 14.0471 4.76148L12.6236 5.23425ZM4.24857 5.41662V15.8357H5.74857V5.41662H4.24857ZM4.24857 15.8357C4.24857 17.1708 5.33086 18.2531 6.66593 18.2531V16.7531C6.15928 16.7531 5.74857 16.3424 5.74857 15.8357H4.24857ZM6.66593 18.2531H13.3354V16.7531H6.66593V18.2531ZM13.3354 18.2531C14.6704 18.2531 15.7527 17.1708 15.7527 15.8357H14.2527C14.2527 16.3424 13.842 16.7531 13.3354 16.7531V18.2531ZM15.7527 15.8357V4.99995H14.2527V15.8357H15.7527ZM10.918 8.33259V14.1684H12.418V8.33259H10.918ZM7.58329 8.33259V14.1684H9.08329V8.33259H7.58329ZM3.74805 5.74787H16.2533V4.24787H3.74805V5.74787ZM7.37744 5.23504L7.83096 3.87447L6.40794 3.40013L5.95442 4.7607L7.37744 5.23504ZM7.83102 3.8743C7.95585 3.49952 8.30657 3.24673 8.7016 3.24683L8.70196 1.74683C7.66102 1.74658 6.73682 2.41271 6.40788 3.4003L7.83102 3.8743ZM8.70178 3.24683H11.2995V1.74683H8.70178V3.24683ZM11.3005 3.24683C11.6958 3.24634 12.047 3.4992 12.1719 3.8743L13.5951 3.4003C13.2659 2.41186 12.3404 1.74554 11.2986 1.74683L11.3005 3.24683ZM12.1717 3.87369L12.6236 5.23425L14.0471 4.76148L13.5953 3.40092L12.1717 3.87369Z"
                    fill="#2E5500" />
            </svg>
        </div>
    );
}

// Вспомогательные функции для работы с корзиной (можно вынести в отдельный файл utils/cart.js)
export const getCart = () => {
    const cartData = localStorage.getItem('vitaline_cart');
    return cartData ? JSON.parse(cartData) : { items: [] };
};

export const updateCart = (cart) => {
    localStorage.setItem('vitaline_cart', JSON.stringify(cart));
    window.dispatchEvent(new Event('cartUpdate'));
};
